(window.webpackJsonp=window.webpackJsonp||[]).push([[170],{616:function(s,t,a){"use strict";a.r(t);var e=a(40),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"高效简单的服务器登录配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#高效简单的服务器登录配置"}},[s._v("#")]),s._v(" 高效简单的服务器登录配置")]),s._v(" "),a("p",[s._v("当你拥有了属于自己的一台云服务器后，首先需要做的事情就是登录服务器。")]),s._v(" "),a("p",[s._v("而登录服务器，作为新手可以通过云厂商提供的 dashboard 进行登录操作。但是，最简单及最方便的方式还是通过终端，使用 "),a("code",[s._v("ssh")]),s._v(" 命令快速登录")]),s._v(" "),a("p",[s._v("本节主要涉及以下四个实践操作，这也是山月关于个人服务器管理的第一篇文章，欢迎持续关注")]),s._v(" "),a("ol",[a("li",[s._v("快速登录: 配置客户端 ssh-config")]),s._v(" "),a("li",[s._v("免密登录: 配置 public key")]),s._v(" "),a("li",[s._v("禁用密码：配置服务器 ssh-config")]),s._v(" "),a("li",[s._v("保持连接：控制ssh不被断开")])]),s._v(" "),a("blockquote",[a("p",[s._v("你对流程熟悉后，只需要一分钟便可以操作完成")])]),s._v(" "),a("ul",[a("li",[s._v("原文地址: "),a("a",{attrs:{href:"https://shanyue.tech/op/init.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("云服务器初始登录配置"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("系列文章: "),a("a",{attrs:{href:"https://shanyue.tech/op/",target:"_blank",rel:"noopener noreferrer"}},[s._v("服务器运维笔记"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"登录服务器-ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登录服务器-ssh"}},[s._v("#")]),s._v(" 登录服务器: ssh")]),s._v(" "),a("p",[s._v("把以下 IP 地址替换为你云服务器的公网地址，并提供密码即可登录。但记住一个 IP 地址，这是一个反人性的操作，如果你有多个服务器呢？此时 "),a("code",[s._v("ssh-config")]),s._v(" 就派上了用场")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@172.16.3.2\n")])])]),a("h2",{attrs:{id:"快速登录-ssh-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速登录-ssh-config"}},[s._v("#")]),s._v(" 快速登录：ssh-config")]),s._v(" "),a("p",[s._v("在本地客户端环境 (个人电脑) 上配置 ssh-config，对个人服务器起别名，可以更方便地登录云服务器，以下是关于 ssh-config 的配置文件")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("/etc/ssh/ssh_config")])]),s._v(" "),a("li",[a("code",[s._v("~/.ssh/config")])])]),s._v(" "),a("p",[s._v("以下是快速登录山月两个服务器 "),a("code",[s._v("shanyue")]),s._v(" 和 "),a("code",[s._v("shuifeng")]),s._v(" 的配置")]),s._v(" "),a("div",{staticClass:"language-config extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 修改 ssh 配置文件 ~/.ssh/config\n\nHost shanyue\n    HostName 59.110.216.155\n    User root\nHost shuifeng\n    HostName <PUBLIC_IP>\n    User root\n")])])]),a("p",[s._v("配置成功之后直接 ssh host 名称就可以，是不是很方便呢？")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" shanyue\nThe authenticity of "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'59.110.216.155 (59.110.216.155)'")]),s._v(" can"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t be established.\nECDSA key fingerprint is SHA256:WXULVpZcrX6kENrR5GH0mqRi49Djj22UXba0dRXCVKo.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59.110")]),s._v(".216.155' "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ECDSA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to the list of known hosts.\n\nWelcome to Alibaba Cloud Elastic Compute Service "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@shanyue ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@shanyue ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@shanyue ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),a("h2",{attrs:{id:"免密登录-public-key-与-ssh-copy-id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#免密登录-public-key-与-ssh-copy-id"}},[s._v("#")]),s._v(" 免密登录：public-key 与 ssh-copy-id")]),s._v(" "),a("p",[s._v("不过仅仅有了别名，每次输入密码也是足够麻烦的。"),a("strong",[s._v("那如何实现远程服务器的免密登录?")])]),s._v(" "),a("ol",[a("li",[s._v("两个文件: 本地环境的 "),a("code",[s._v("~/.ssh/id_rsa.pub")]),s._v(" 与 远程服务器的 "),a("code",[s._v("~/.ssh/authorized_keys")])]),s._v(" "),a("li",[s._v("一个动作：把本地文件中的内容复制粘贴到远程服务器中")])]),s._v(" "),a("blockquote",[a("p",[s._v("如果本地环境中 ~/.ssh/id_rsa.pub 文件不存在，请参考下一章节使用 ssh-keygen 生成 ssh keys: "),a("a",{attrs:{href:"https://shanyue.tech/op/ssh-setting.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("ssh key 及 git 配置"),a("OutboundLink")],1)])]),s._v(" "),a("p",[a("strong",[s._v("总结成一句话，即把自己的公钥放在远程服务器。")])]),s._v(" "),a("p",[s._v("简单来说，就是 "),a("code",[s._v("Ctrl-C")]),s._v(" 与 "),a("code",[s._v("Ctrl-V")]),s._v(" 操作，不过具体实施起来较为琐碎。 "),a("strong",[s._v("更为重要的是对于新人还有一个门槛：vim 的使用")]),s._v("。")]),s._v(" "),a("blockquote",[a("p",[s._v("关于 vim，可以参考后续文章 "),a("a",{attrs:{href:"https://shanyue.tech/op/vim-setting.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("vim 基本操作及其配置"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("此时一个解决生产力的命令行工具应运而生: "),a("code",[s._v("ssh-copy-id")])]),s._v(" "),a("div",{staticClass:"language-ssh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 在本地环境进行操作\n\n# 提示你输入密码，成功之后可以直接 ssh 登录，无需密码\n$ ssh-copy-id shanyue\n\n# 登陆成功，无需密码\n$ ssh shanyue\n")])])]),a("h2",{attrs:{id:"禁用密码登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#禁用密码登录"}},[s._v("#")]),s._v(" 禁用密码登录")]),s._v(" "),a("p",[s._v("为了更大保障服务器的安全性，这里禁止密码登录。修改云服务器的 "),a("code",[s._v("sshd")]),s._v(" 配置文件："),a("code",[s._v("/etc/ssh/sshd_config")]),s._v("。其中 "),a("code",[s._v("PasswordAuthentication")]),s._v(" 设置为 "),a("code",[s._v("no")]),s._v("，以此来禁用密码登录。")]),s._v(" "),a("div",{staticClass:"language-config extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 编辑服务器端的 /etc/ssh/sshd_config\n# 禁用密码登录\nHost *\n  PasswordAuthentication no\n")])])]),a("h2",{attrs:{id:"保持连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#保持连接"}},[s._v("#")]),s._v(" 保持连接")]),s._v(" "),a("p",[s._v("此时仿佛一切都顺心遂意，心满意足，于是，山月趁空接了杯水喝。然而回来发现，ssh 超时断开连接，并因此 hang 住了，这怎么能忍？")]),s._v(" "),a("p",[s._v("在客户端的 ssh-config 配置文件中，加两行配置搞定。")]),s._v(" "),a("div",{staticClass:"language-config extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Host *\n  ServerAliveInterval 60\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);