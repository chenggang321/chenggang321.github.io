(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{400:function(s,t,a){s.exports=a.p+"assets/img/cli.ad5e34f5.png"},401:function(s,t,a){s.exports=a.p+"assets/img/md-cli.6acf3b35.png"},524:function(s,t,a){"use strict";a.r(t);var n=a(40),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"使用-node-开发一个命令行工具"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用-node-开发一个命令行工具"}},[s._v("#")]),s._v(" 使用 Node 开发一个命令行工具")]),s._v(" "),n("p",[s._v("使用 Node 开发一个命令行工具在工作中也较为常见，也很有意思，较为其它语言而言也更加简单，今天写一篇文章总结一下如何写一个友好健壮的 cli 工具")]),s._v(" "),n("p",[s._v("在阅读完本篇文章之后，可以阅读 Github 上的一篇文章: "),n("a",{attrs:{href:"https://github.com/lirantal/nodejs-cli-apps-best-practices",target:"_blank",rel:"noopener noreferrer"}},[s._v("Node CLI 工具最佳实践"),n("OutboundLink")],1)]),s._v(" "),n("h2",{attrs:{id:"命令行工具"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#命令行工具"}},[s._v("#")]),s._v(" 命令行工具")]),s._v(" "),n("p",[s._v("什么是命令行工具？")]),s._v(" "),n("p",[s._v("最初印象大致是 "),n("code",[s._v("ls")]),s._v("，"),n("code",[s._v("pwd")]),s._v(" 这些能够"),n("strong",[s._v("在终端执行的系统命令")]),s._v("，这样的命令有很多，数不胜数，被称为系统内置命令。如果使用 "),n("code",[s._v("which")]),s._v(" 查看他们的来历，则能够发现他们的庐山真面目:")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),s._v("\npwd: shell built-in "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\n")])])]),n("p",[s._v("随着对 Linux/Unix 系统理解及使用的逐渐加深，发现了诸多的非内置命令:")]),s._v(" "),n("ul",[n("li",[s._v("top")]),s._v(" "),n("li",[s._v("ps")]),s._v(" "),n("li",[s._v("netstat")]),s._v(" "),n("li",[s._v("dig")]),s._v(" "),n("li",[s._v("man")])]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v("which")]),s._v(" 侦查情况，发现他们实际执行的路径在某一个 bin 目录")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v("\n/usr/bin/top\n\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n/bin/ps\n")])])]),n("p",[s._v("而这些 bin 目录在环境变量 PATH 中，豁然开朗。简而言之: "),n("strong",[s._v("在 PATH 中路径的命令可在其它任意地方执行")]),s._v("。")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/bin:/usr/local/bin:"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n")])])]),n("p",[s._v("你好像想起点什么？在大学配置 Java 时被环境变量支配的各种恐惧？是了，所有语言的可执行命令都要放在 "),n("code",[s._v("PATH")]),s._v(" 下，只不过其它语言自动给你做了，而 Java 让你自己做这件事。")]),s._v(" "),n("ul",[n("li",[s._v("java")]),s._v(" "),n("li",[s._v("python")]),s._v(" "),n("li",[s._v("pip")]),s._v(" "),n("li",[s._v("node")]),s._v(" "),n("li",[s._v("npm")])]),s._v(" "),n("p",[s._v("开发命令行的原理也是如此，而本篇文章的目标就是:")]),s._v(" "),n("p",[n("strong",[s._v("使用 Javascript 这门前端开发者熟悉的语言，借助 Node 环境，开发一个命令行工具。")])]),s._v(" "),n("h2",{attrs:{id:"原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[s._v("#")]),s._v(" 原理")]),s._v(" "),n("p",[s._v("先看两个命令行工具: "),n("code",[s._v("serve")]),s._v(" 一个流行的静态文件服务器，"),n("code",[s._v("markdown")]),s._v(" 一个我自己写的解析 URL 到 markdow 的命令行。通过命令解析出他们指向的符号链接")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -lah "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" serve"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\nlrwxr-xr-x  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xiange  admin    65B  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" /usr/local/bin/serve -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/Users/shanyue/.config/yarn/global/node_modules/.bin/serve\n\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -lah "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" markdown"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\nlrwxr-xr-x  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xiange  admin    48B  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":06 /usr/local/bin/markdown -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/lib/node_modules/markdown-read/md-read-cli.js\n")])])]),n("p",[s._v("从中可以看出他们关于命令行的解析:")]),s._v(" "),n("ol",[n("li",[s._v("npm 全局下载 Package 到 /usr/local/lib/node_modules 下 (yarn 同理)")]),s._v(" "),n("li",[s._v("根据 package.json 中 bin 选项的指示，对应的二进制脚本挂载到 PATH 路径")]),s._v(" "),n("li",[s._v("对应的二进制脚本添加 x 权限 (可执行文件权限)")])]),s._v(" "),n("p",[s._v("简而言之，Node 环境下的命令行工具，借助的原理无非是环境变量 Path 与一个符号链接")]),s._v(" "),n("h2",{attrs:{id:"从-package-json-说起"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#从-package-json-说起"}},[s._v("#")]),s._v(" 从 package.json 说起")]),s._v(" "),n("p",[s._v("在 "),n("strong",[s._v("package.json 中的 bin 选项")]),s._v("，用以指定最终的命令行工具的名字")]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"bin"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"markdown"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./md-read-cli"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("p",[s._v("如上所示，"),n("code",[s._v("markdown")]),s._v(" 是最终在终端执行的命令，而 "),n("code",[s._v("./md-read-cli")]),s._v(" 是该命令实际执行的文件。")]),s._v(" "),n("p",[s._v("对于最终可执行的命令行工具，Node 项目一般倾向置文件于 "),n("code",[s._v("bin")]),s._v(" 目录下，如以下 Typescript 的配置:")]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"bin"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"tsc"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./bin/tsc"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"tsserver"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./bin/tsserver"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("h2",{attrs:{id:"一个执行环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一个执行环境"}},[s._v("#")]),s._v(" 一个执行环境")]),s._v(" "),n("p",[s._v("对于可直接执行的文件，需要指明执行环境，首行添加一行说明:")]),s._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("#"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("env node\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// code 往下写")]),s._v("\n")])])]),n("p",[s._v("这一句话是啥子意思了？")]),s._v(" "),n("ol",[n("li",[n("code",[s._v("#!")]),s._v(" 后接解释器，标明该文件使用 "),n("code",[s._v("/usr/bin/env node")]),s._v(" 来执行")]),s._v(" "),n("li",[n("code",[s._v("/usr/bin/env")]),s._v(" 为 env 的绝对路径，用以在 PATH 路径中执行命令 (在各种不同的系统中，node 命令行的位置不同，因此使用 "),n("code",[s._v("env node")]),s._v(" 找到路径并执行)")]),s._v(" "),n("li",[n("code",[s._v("env node")]),s._v(" 在人为层面可理解为执行 "),n("code",[s._v("node")]),s._v(" 命令")])]),s._v(" "),n("p",[s._v("所以这句话的意思是: "),n("strong",[s._v("使用 node 执行这个脚本")])]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("// 不写 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/env node")]),s._v("\n$ node serve "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n// 写上 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/env node")]),s._v("\n$ serve "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])])]),n("h2",{attrs:{id:"解析命令输入"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#解析命令输入"}},[s._v("#")]),s._v(" 解析命令输入")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ node cmd.js "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])])]),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Output: [")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   '/usr/local/bin/node',")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   '/Users/shanyue/cmd.js',")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   '1',")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   '2',")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   '3',")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ]")]),s._v("\nprocess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("argv\n")])])]),n("p",[s._v("根据解析 "),n("code",[s._v("process.argv")]),s._v(" 来获取各式各样的参数作为命令行的输入，当然解析参数也要参照基本规律: 格式、可选、必选、简写、说明、帮助等等。"),n("a",{attrs:{href:"https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("命令行工具命名协议"),n("OutboundLink")],1),s._v(" 文章中已说的足够详细。")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("// 一个较为规整的命令行帮助\n$ node --help\nUsage: node "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" script.js "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arguments"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n       node inspect "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" script.js "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" host:port "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arguments"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nOptions:\n  -                                         script "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" from stdin "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" no "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" name is provided,\n                                            interactive mode "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" a "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tty")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  --                                        indicate the end of node options\n  --abort-on-uncaught-exception             aborting instead of exiting causes a core "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" to be generated "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v("\n                                            analysis\n  -c, --check                               syntax check script without executing\n  --completion-bash                         print source-able "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" completion script\n  --cpu-prof                                Start the V8 CPU profiler on start up, and "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" the CPU profile to\n                                            disk before exit. If --cpu-prof-dir is not specified, "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" the profile\n                                            to the current working directory.\n")])])]),n("p",[s._v("以此衍生出了关于解析命令参数的多个库，在实际工作中就直接用吧！")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/yargs/yargs",target:"_blank",rel:"noopener noreferrer"}},[s._v("yargs"),n("OutboundLink")],1),s._v(": Star 8.5K，周下载量 4900K")]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/tj/commander.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("commander"),n("OutboundLink")],1),s._v(": Star 19.7K，周下载量 5300K，tj 大神的作品")])]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v("commander")]),s._v(" 解析不同的输入指令")]),s._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" program "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'commander'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 解析不同的指令输入")]),s._v("\nprogram\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-d, --debug'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'output extra debugging'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-s, --small'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'small pizza size'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-p, --pizza-type <type>'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'flavour of pizza'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nprogram"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("argv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" options "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" program"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("opts")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),n("h2",{attrs:{id:"丰富的色彩体验"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#丰富的色彩体验"}},[s._v("#")]),s._v(" 丰富的色彩体验")]),s._v(" "),n("p",[n("img",{attrs:{src:a(400),alt:"Next 构建输出"}})]),s._v(" "),n("p",[s._v("目前大部分终端已支持彩色输出，丰富的高亮色彩如同代码高亮一样使用户可以快速抓住重点。把异常、警告、成功的信息用不同的颜色标出，命令行工具的输出一目了然。在现代构建工具，如 Webpack 下，也大都支持彩色输出。")]),s._v(" "),n("p",[s._v("以下是在命令行工具中常用的两个色彩库，支持多种多样色彩的输出。")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.npmjs.com/package/chalk",target:"_blank",rel:"noopener noreferrer"}},[s._v("chalk"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.npmjs.com/package/colors",target:"_blank",rel:"noopener noreferrer"}},[s._v("colors"),n("OutboundLink")],1)])]),s._v(" "),n("p",[s._v("以下是 "),n("code",[s._v("chalk")]),s._v(" 示例，"),n("code",[s._v("Error")]),s._v(" 与 "),n("code",[s._v("Warning")]),s._v(" 信息用不同的颜色表示")]),s._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" chalk "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'chalk'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" error "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" chalk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bold"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("red\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" warning "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" chalk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("keyword")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'orange'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n \nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Error!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("warning")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Warning!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),n("h2",{attrs:{id:"发布与安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#发布与安装"}},[s._v("#")]),s._v(" 发布与安装")]),s._v(" "),n("p",[s._v("在辛苦努力写完一个 cli 工具后，就是检验成果的时候。发布到 npm 仓库，可使所有人使用你的命令行工具，这也是最重要的一步")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布之前需要 npm login，登录到 npm registory")]),s._v("\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish\n")])])]),n("p",[s._v("发版成功后全局下载命令行工具，开始使用，示例用它抓取下我的博客首页")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i -g markdown-read\n/usr/local/bin/markdown -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/local/lib/node_modules/markdown-read/md-read-cli.js\n+ markdown-read@1.1.0\nadded "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("102")]),s._v(" packages from "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("72")]),s._v(" contributors and updated "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" packages "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v(".15s\n\n$ markdown https://shanyue.tech\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## [#](#山月的琐碎博客记录) 山月的琐碎博客记录")]),s._v("\n\n本博客关于平常工作中在前端，后端以及运维中遇到问题的一些文章总结。以后也会做系列文章进行输出，如前端高级进阶系列，个人服务器指南系列。个人微信 shanyue94，欢迎添加交流\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## [#](#名字由来) 名字由来")]),s._v("\n")])])]),n("h2",{attrs:{id:"总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),n("p",[s._v("本篇文章由浅至深讲解了以下几方面的内容:")]),s._v(" "),n("ol",[n("li",[s._v("一个全局可执行的命令行工具的原理是什么")]),s._v(" "),n("li",[s._v("在 Node 中开发一个命令行工具所需要的配置")]),s._v(" "),n("li",[s._v("开发命令行工具时如何解析参数")])]),s._v(" "),n("p",[s._v("并根据实践，开发了一个从 URL 中读取 Markdown 的小工具: "),n("a",{attrs:{href:"https://github.com/shfshanyue/markdown-read",target:"_blank",rel:"noopener noreferrer"}},[s._v("markdown-read"),n("OutboundLink")],1),s._v("，欢迎 Star、下载及使用。")]),s._v(" "),n("p",[s._v("另外，我基于此命令行做了一个 Web 版，欢迎来体验: "),n("a",{attrs:{href:"https://devtool.tech/html-md",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://devtool.tech/html-md"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("img",{attrs:{src:a(401),alt:"HTML To Markdown 网页版"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);