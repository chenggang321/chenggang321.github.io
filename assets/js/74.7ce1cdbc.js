(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{484:function(e,t,s){"use strict";s.r(t);var a=s(40),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"部署利器-helm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署利器-helm"}},[e._v("#")]),e._v(" 部署利器: helm")]),e._v(" "),s("blockquote",[s("p",[e._v("山月最近想起来自己还有一个 k8s 集群，决定输出一些云原生的文章，在我的 github 仓库 "),s("a",{attrs:{href:"https://github.com/shfshanyue/learn-k8s",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/shfshanyue/learn-k8s"),s("OutboundLink")],1),e._v(" 可以看到。本篇文章主要介绍 helm，说到它，实在是太简单太好用，在 k8s 上部署应用就和傻瓜似的...傻瓜式一键安装，你值得拥有")])]),e._v(" "),s("p",[s("code",[e._v("helm")]),e._v(" 是基于 "),s("code",[e._v("kubernetes")]),e._v(" 的包管理器。它之于 "),s("code",[e._v("kubernetes")]),e._v(" 就如 "),s("code",[e._v("yum")]),e._v(" 之于 "),s("code",[e._v("centos")]),e._v("，"),s("code",[e._v("pip")]),e._v(" 之于 "),s("code",[e._v("python")]),e._v("，"),s("code",[e._v("npm")]),e._v(" 之于 "),s("code",[e._v("javascript")]),e._v("。")]),e._v(" "),s("p",[e._v("那 "),s("code",[e._v("helm")]),e._v(" 的引入对于管理集群有哪些帮助呢？可体现在基础运维建设及业务应用两方面")]),e._v(" "),s("ol",[s("li",[e._v("基础设施，更方便地部署与升级基础设施，如 "),s("code",[e._v("gitlab")]),e._v("，"),s("code",[e._v("prometheus")]),e._v("，"),s("code",[e._v("grafana")]),e._v("，"),s("code",[e._v("ES")]),e._v(" 等")]),e._v(" "),s("li",[e._v("业务应用，更方便地部署，管理与升级公司内部应用，为公司内部的项目配置 Chart，使用 "),s("code",[e._v("helm")]),e._v(" 结合 CI，在 k8s 中部署应用如一行命令般简单")])]),e._v(" "),s("p",[s("strong",[e._v("当然 "),s("code",[e._v("helm")]),e._v(" 更伟大的在于它的思想上："),s("code",[e._v("Separation of concerns")]),e._v("。使得运维人员与开发人员进一步职责分离")]),e._v("。")]),e._v(" "),s("p",[e._v("让开发人员写 "),s("code",[e._v("k8s")]),e._v(" 资源配置文件是不现实的")]),e._v(" "),s("ol",[s("li",[e._v("不是所有开发都了解k8s，或者说很少，不了解 k8s 很难写资源配置部署文件")]),e._v(" "),s("li",[e._v("开发的主要职能还是在业务上")])]),e._v(" "),s("p",[e._v("于是 "),s("code",[e._v("helm")]),e._v(" 应时而出，运维通过 "),s("code",[e._v("helm")]),e._v(" 配置好资源文件模板，然后交给开发填参数。")]),e._v(" "),s("p",[e._v("本篇文章主要介绍如何安装 helm 以及如何使用 helm 部署基础服务和业务")]),e._v(" "),s("ul",[s("li",[e._v("原文地址: "),s("a",{attrs:{href:"https://shanyue.tech/k8s/helm.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("部署利器 helm 安装及使用指南"),s("OutboundLink")],1)]),e._v(" "),s("li",[e._v("系列文章: "),s("a",{attrs:{href:"https://shanyue.tech/op/",target:"_blank",rel:"noopener noreferrer"}},[e._v("个人服务器运维指南"),s("OutboundLink")],1)])]),e._v(" "),s("h2",{attrs:{id:"安装-helm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-helm"}},[e._v("#")]),e._v(" 安装 helm")]),e._v(" "),s("p",[e._v("这里参考官方文档 "),s("a",{attrs:{href:"https://helm.sh/docs/intro/install/",target:"_blank",rel:"noopener noreferrer"}},[e._v("安装 helm"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("code",[e._v("helm")]),e._v(" 此时已发布了 v3，本篇文章关于 "),s("code",[e._v("helm")]),e._v(" 安装及使用指南以 "),s("code",[e._v("helm v3")]),e._v(" 为基础。")]),e._v(" "),s("blockquote",[s("p",[s("code",[e._v("helm")]),e._v(" 在 helm v2 时分为客户端 (helm client，即命令行工具) 与服务端 (helm server) 两部分，在服务端又叫 "),s("code",[e._v("Tiller")]),e._v("，安装 "),s("code",[e._v("Tiller")]),e._v(" 时会在集群中部署一个 "),s("code",[e._v("Pod")]),e._v("，用以接替资源部署。")])]),e._v(" "),s("h3",{attrs:{id:"安装客户端-helm-client"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装客户端-helm-client"}},[e._v("#")]),e._v(" 安装客户端 (helm client)")]),e._v(" "),s("p",[e._v("helm client 需要安装在你可以访问 k8s 集群的任何服务器，如同 "),s("code",[e._v("kubectl")]),e._v("，你既可以安装在你自己的 "),s("code",[e._v("PC/Mac")]),e._v(" 中，也可以安装在 "),s("code",[e._v("kubectl")]),e._v(" 集群环境的主节点")]),e._v(" "),s("p",[e._v("在 mac 上进行安装")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("$ brew "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" kubernetes-helm\n")])])]),s("p",[e._v("在 linux 上进行安装")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("700")]),e._v(" get_helm.sh\n$ ./get_helm.sh\n")])])]),s("p",[e._v("根据二进制包进行安装，比较推荐，毕竟使用以上两种方案在目标机可能有网络问题")]),e._v(" "),s("ol",[s("li",[e._v("需要在代理节点下载二进制脚本")]),e._v(" "),s("li",[e._v("使用 "),s("code",[e._v("rsync")]),e._v(" 或者 "),s("code",[e._v("scp")]),e._v(" 将脚本移动到目标机目标位置")])]),e._v(" "),s("p",[e._v("示例选择 "),s("code",[e._v("3.2.3")]),e._v(" 进行安装，"),s("code",[e._v("helm")]),e._v(" 的最新版本可以参考 "),s("a",{attrs:{href:"https://github.com/helm/helm/releases",target:"_blank",rel:"noopener noreferrer"}},[e._v("helm/helm Releases"),s("OutboundLink")],1),e._v("。")]),e._v(" "),s("blockquote",[s("p",[e._v("可以选择 3.0+ 版本的安装，目前最新版本是 "),s("code",[e._v("Helm v3.0.0-rc.1")]),e._v(" (2019/11/01)")])]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 下载 MAC 上适用的软件包")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# -L: 追踪重定向链接")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# -O: 保存到本地")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# -S: 打印错误")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -SLO https://get.helm.sh/helm-v3.2.3-darwin-amd64.tar.gz \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 下载 CentOS 上适用的软件包")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -SLO https://get.helm.sh/helm-v3.2.3-linux-amd64.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 如果有网络问题，请在代理节点下载并 rsync 到目标节点，如果没有，跳过此步")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("rsync")]),e._v(" -avhzP proxy:/root/helm-v3.2.3-linux-amd64.tar.gz "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(".")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 如果在 mac 上")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("tar")]),e._v(" -zxvf helm-v3.2.3-darwin-amd64.tar.gz \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 如果在 centos 上")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("tar")]),e._v(" -zxvf helm-v3.2.3-linux-amd64.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 进入相应目录，移至 /bin 目录")]),e._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" linux-amd64/helm /usr/local/bin/helm\n")])])]),s("p",[e._v("此时 "),s("code",[e._v("helm v3")]),e._v(" 安装成功，使用 "),s("code",[e._v("helm version")]),e._v(" 查看版本号")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ helm version\nversion.BuildInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("Version:"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"v3.2.3"')]),e._v(", GitCommit:"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"8f832046e258e2cb800894579b1b3b50c2d83492"')]),e._v(", GitTreeState:"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"clean"')]),e._v(", GoVersion:"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"go1.13.12"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("h2",{attrs:{id:"介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[e._v("#")]),e._v(" 介绍")]),e._v(" "),s("p",[e._v("在 "),s("code",[e._v("helm")]),e._v(" 中有三个关键概念："),s("code",[e._v("Chart")]),e._v("，"),s("code",[e._v("Repo")]),e._v(" 及 "),s("code",[e._v("Release")])]),e._v(" "),s("ul",[s("li",[s("code",[e._v("Chart")]),e._v(": 一系列 k8s 资源集合的命名，它包含一系列 k8s 资源配置文件的模板与参数，可供灵活配置")]),e._v(" "),s("li",[s("code",[e._v("Repo")]),e._v(": 即 chart 的仓库，其中有很多个 chart 可供选择，如官方 "),s("a",{attrs:{href:"https://github.com/helm/charts",target:"_blank",rel:"noopener noreferrer"}},[e._v("helm/charts"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("code",[e._v("Release")]),e._v(": 当一个 Chart 部署后生成一个 release")])]),e._v(" "),s("h3",{attrs:{id:"chart-简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#chart-简介"}},[e._v("#")]),e._v(" Chart 简介")]),e._v(" "),s("p",[e._v("使用 "),s("code",[e._v("helm create")]),e._v(" 创建一个 chart，了解简单 chart 的目录结构")]),e._v(" "),s("blockquote",[s("p",[e._v("关于如何安装 helm 参考下一小节")])]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 创建一个 chart")]),e._v("\n$ helm create todo\nCreating todo\n\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" todo\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 打印 chart 目录，主要文件有 Chart.yaml 与 values.yaml")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# --dirsfirst 先打印文件夹名称")]),e._v("\n$ tree --dirsfirst\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(".")]),e._v("\n├── charts\n├── templates\n│   ├── tests\n│   │   └── test-connection.yaml\n│   ├── NOTES.txt\n│   ├── _helpers.tpl\n│   ├── deployment.yaml\n│   ├── ingress.yaml\n│   └── service.yaml\n├── Chart.yaml\n└── values.yaml\n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v(" directories, "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8")]),e._v(" files\n")])])]),s("p",[e._v("查看主要的两个文件目录")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("templates/")]),e._v(": 这是运维大哥写的配置文件模板，示例是最简单应用的资源配置，但复杂应用还会有 pvc，role，service-acount 等等")]),e._v(" "),s("li",[s("code",[e._v("values.yaml")]),e._v(": 这是给开发小弟写的可选参数，但是大部分参数都被运维大哥给内置了")])]),e._v(" "),s("h2",{attrs:{id:"使用-helm-部署基础服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-helm-部署基础服务"}},[e._v("#")]),e._v(" 使用 helm 部署基础服务")]),e._v(" "),s("p",[e._v("真实案例可以参看我的系列文章其它章节")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://shanyue.tech/k8s/deploy-redis.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("使用 helm 部署 redis"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://shanyue.tech/k8s/deploy-postgres.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("使用 helm 部署 postgres"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://shanyue.tech/k8s/deploy-drone.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("使用 helm 部署 drone"),s("OutboundLink")],1)])]),e._v(" "),s("p",[e._v("这里讲述一些关于部署基础服务的一般步骤，假设我们需要部署 redis")]),e._v(" "),s("blockquote",[s("p",[e._v("这里使用 helm v3，语法与 v2 可能略有出入")])]),e._v(" "),s("h3",{attrs:{id:"_00-添加相关-repo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_00-添加相关-repo"}},[e._v("#")]),e._v(" 00 添加相关 Repo")]),e._v(" "),s("p",[e._v("通过 "),s("code",[e._v("helm repo add")]),e._v(" 可以添加 Repo，这里列出几个频率使用较高的 Repo")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/helm/charts",target:"_blank",rel:"noopener noreferrer"}},[e._v("helm"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://hub.helm.sh/charts/bitnami",target:"_blank",rel:"noopener noreferrer"}},[e._v("bitnami"),s("OutboundLink")],1)])]),e._v(" "),s("p",[e._v("如果在国内有网络问题，可以使用阿里云镜像")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ helm repo "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" stable https://apphub.aliyuncs.com/stable\n\n$ helm repo "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" bitnami https://charts.bitnami.com/bitnami\n")])])]),s("p",[e._v("另外，对于一些大软件公司也会维护自己的 Chart，如 "),s("code",[e._v("gitlab")]),e._v("，"),s("code",[e._v("elasti")])]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://hub.helm.sh/charts/elastic",target:"_blank",rel:"noopener noreferrer"}},[e._v("elastic"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://hub.helm.sh/charts/gitlab",target:"_blank",rel:"noopener noreferrer"}},[e._v("gitlab"),s("OutboundLink")],1)])]),e._v(" "),s("h3",{attrs:{id:"_01-查找相关-chart"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_01-查找相关-chart"}},[e._v("#")]),e._v(" 01 查找相关 Chart")]),e._v(" "),s("p",[e._v("使用 "),s("code",[e._v("helm search hub")])]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ helm search repo redis\nNAME                                    CHART VERSION   APP VERSION     DESCRIPTION\napphub/prometheus-redis-exporter        "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("3.1")]),e._v(".0           "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".4           Prometheus exporter "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" Redis metrics\napphub/redis                            "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("9.3")]),e._v(".1           "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.0")]),e._v(".5           Open source, advanced key-value store. It is of"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\napphub/redis-cache                      "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.4")]),e._v(".1           "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.0")]),e._v(".12-alpine   A pure in-memory redis cache, using statefulset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\napphub/redis-ha                         "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("3.8")]),e._v(".0           "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.0")]),e._v(".5           Highly available Kubernetes implementation of R"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\napphub/redis-operator                   "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".0                           Redis Operator provides high availability redis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\napphub/redispapa                        "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.0")]),e._v(".1           "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.0")]),e._v(".1           利用redis的info信息对redis的使用情况进行监控的一"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nbitnami/redis                           "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.7")]),e._v(".1          "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6.0")]),e._v(".5           Open source, advanced key-value store. It is of"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nbitnami/redis-cluster                   "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2.3")]),e._v(".1           "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6.0")]),e._v(".5           Open source, advanced key-value store. It is of"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nstable/prometheus-redis-exporter        "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("3.4")]),e._v(".1           "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.3")]),e._v(".4           Prometheus exporter "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" Redis metrics\nstable/redis                            "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.5")]),e._v(".7          "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.0")]),e._v(".7           DEPRECATED Open source, advanced key-value stor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nstable/redis-ha                         "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.4")]),e._v(".4           "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.0")]),e._v(".6           Highly available Kubernetes implementation of R"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\napphub/codis                            "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("3.2")]),e._v("             "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("3.2")]),e._v("             A Helm chart "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" Codis\n")])])]),s("h3",{attrs:{id:"_02-选定-chart-跟进-chart-的官方文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_02-选定-chart-跟进-chart-的官方文档"}},[e._v("#")]),e._v(" 02 选定 Chart，跟进 Chart 的官方文档")]),e._v(" "),s("p",[e._v("我们选定 "),s("a",{attrs:{href:"https://hub.helm.sh/charts/bitnami/redis",target:"_blank",rel:"noopener noreferrer"}},[e._v("stable/redis"),s("OutboundLink")],1),e._v(" 这个 chart。")]),e._v(" "),s("p",[e._v("跟踪官方文档，设置相关参数，存储为 "),s("code",[e._v("values-production.yaml")])]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Production configuration")]),e._v("\n$ helm "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" redis bitami/redis --values values-production.yaml\n")])])]),s("p",[e._v("如何部署完成，可以查看安装某个 "),s("code",[e._v("Release")]),e._v(" 时的 "),s("code",[e._v("values")])]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ helm get values redis\n")])])]),s("p",[e._v("如果需要升级，使用 "),s("code",[e._v("helm upgrade")])]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ helm upgrade redis bitnami/redis --values values-production.yaml\n")])])]),s("h3",{attrs:{id:"_03-校验部署状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_03-校验部署状态"}},[e._v("#")]),e._v(" 03 校验部署状态")]),e._v(" "),s("p",[e._v("这与需要部署的资源有关，不过一般也就分为 "),s("code",[e._v("Service")]),e._v("，"),s("code",[e._v("Pod")]),e._v(" 和 "),s("code",[e._v("PVC")])]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("helm status redis\nNAME: redis\nLAST DEPLOYED: Fri Nov  "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("21")]),e._v(":07:24 "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2019")]),e._v("\nNAMESPACE: default\nSTATUS: deployed\nREVISION: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("\nTEST SUITE: None\nNOTES:\n** Please be patient "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("while")]),e._v(" the chart is being deployed **\nRedis can be accessed via port "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6379")]),e._v(" on the following DNS name from within your cluster:\n\nredis-master.default.svc.cluster.local\n")])])]),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),s("p",[e._v("本篇文章介绍了如何安装 "),s("code",[e._v("helm v3")]),e._v("，及如何使用 "),s("code",[e._v("helm")]),e._v(" 快速部署应用，简单总结为两条命令")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 在有 k8s 管理权限的 mac 上安装 helm")]),e._v("\n$ brew "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" helm\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 使用 helm 安装 redis")]),e._v("\n$ helm "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" redis bitnami/redis\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);