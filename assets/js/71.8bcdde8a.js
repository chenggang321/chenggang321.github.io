(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{478:function(s,t,a){"use strict";a.r(t);var n=a(40),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"在-k8s-集群中部署-es"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在-k8s-集群中部署-es"}},[s._v("#")]),s._v(" 在 k8s 集群中部署 ES")]),s._v(" "),a("h2",{attrs:{id:"通过-helm-部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过-helm-部署"}},[s._v("#")]),s._v(" 通过 helm 部署")]),s._v(" "),a("h3",{attrs:{id:"warning"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#warning"}},[s._v("#")]),s._v(" WARNING")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Elasticsearch requires some changes in the kernel of the host machine to\nwork as expected. If those values are not set in the underlying operating\nsystem, the ES containers fail to boot with ERROR messages.\n\nMore information about these requirements can be found in the links below:\n\n  https://www.elastic.co/guide/en/elasticsearch/reference/current/file-descriptors.html\n  https://www.elastic.co/guide/en/elasticsearch/reference/current/vm-max-map-count.html\n\nThis chart uses a privileged initContainer to change those settings in the Kernel\nby running: sysctl -w vm.max_map_count=262144 && sysctl -w fs.file-max=65536\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ sysctl -w vm.max_map_count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("262144")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" sysctl -w fs.file-max"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("\n")])])]),a("h2",{attrs:{id:"查看状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看状态"}},[s._v("#")]),s._v(" 查看状态")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ kubectl get pods\nes-elasticsearch-coordinating-only-54d9f9698f-5mhdx   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7h26m\nes-elasticsearch-coordinating-only-54d9f9698f-xgnsb   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7h26m\nes-elasticsearch-data-0                               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v("         7h26m\nes-elasticsearch-master-0                             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v("         7h26m\n")])])]),a("h2",{attrs:{id:"部署成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署成功"}},[s._v("#")]),s._v(" 部署成功")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" es-elasticsearch-coordinating-only:9200\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"es-elasticsearch-coordinating-only-54d9f9698f-5mhdx"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster_name"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"elastic"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster_uuid"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_na_"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7.7.1"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_flavor"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"oss"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_type"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tar"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_hash"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ad56dce891c901a492bb1ee393f12dfff473a423"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_date"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-05-28T16:30:01.040088Z"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_snapshot"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lucene_version"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8.5.1"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minimum_wire_compatibility_version"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6.8.0"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minimum_index_compatibility_version"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6.0.0-beta1"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tagline"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You Know, for Search"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);